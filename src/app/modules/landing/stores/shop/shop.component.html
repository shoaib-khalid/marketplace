<ng-container *ngIf="store">
    <!-- Main menu -->
    <div class="flex flex-col items-center w-full h-auto">
        <ng-container *ngIf="storeCategories && storeCategories.length">
            <div class="flex flex-col w-full">                
                <!-- Category -->                    
                <div class="flex flex-nowrap items-center justify-start overflow-x-auto rounded-md w-screen md:w-full bg-card md:border-2 md:mx-0 md:mb-2 -mx-2 pt-2 sm:pt-4 sticky top-0 z-40">
                    <div class="grid grid-flow-col grid-rows-1 gap-1 sm:gap-4">
                        <div 
                            [ngClass]="!selectedCategory ? 'border-primary border-b-4 ' : '' "
                            class="flex flex-col h-10 w-28 filter-article justify-center cursor-pointer mb-2 mx-1 first:ml-1 last:mr-1" 
                            (click)="chooseCategory(null)">
                            <span class="m-1 text-sm text-center font-semibold line-clamp-2 leading-4">All</span>
                        </div>
                        <ng-container *ngFor="let category of storeCategories">
                            <div 
                                [ngClass]="selectedCategory && selectedCategory.id === category.id ? 'border-primary border-b-4 ' : '' "
                                class="flex flex-col h-10 w-28 filter-article justify-center cursor-pointer mb-2 mx-1 first:ml-1 last:mr-1" 
                                (click)="chooseCategory(category)">
                                <span class="m-1 text-sm text-center font-semibold line-clamp-2 leading-4">{{category.name}}</span>
                            </div>
                        </ng-container>
                    </div>
                </div>

                <!-- Search -->
                <search class="w-full mb-2 sm:mt-2 sm:mb-4 z-10" [storeId]="store.id" [store]="storeDetails"></search>

                <!-- Sort -->
                <div class="flex flex-row items-start justify-between md:justify-end mt-1 md:mt-0 md:mb-2 w-full pb-2 sm:pb-0">
                    <mat-select
                        class="order-1 md:order-2 border border-gray-300 w-40 p-2 rounded text-sm"
                        placeholder="Sort by name"
                        [formControl]="sortInputControl"
                        #sortSelector="matSelect"
                        >
                        <mat-select-trigger>
                            <span class="flex items-center">
                                <span>{{ sortSelector.triggerValue }}</span>
                            </span>
                        </mat-select-trigger>
                        <ng-container>
                            <mat-option [value]="'recent'">Most Recent</mat-option>
                            <mat-option [value]="'cheapest'">Price : Cheapest</mat-option>
                            <mat-option [value]="'expensive'">Price : Most Expensive</mat-option>
                            <mat-option [value]="'a-z'">Name : Ascending</mat-option>
                            <mat-option [value]="'z-a'">Name : Descending</mat-option>
                        </ng-container>
                    </mat-select>
        
                    <div class="flex flex-row order-2 sm:order-1">
                        <!-- Grid view -->
                        <input
                            id="grid-view-button"
                            type="button"
                            class="absolute h-0 w-0 opacity-0 invisible pointer-events-none"
                            (click)="productViewOrientation = 'grid'"
                            mat-button>
                        <label 
                            class="flex items-center justify-center h-10 px-1 cursor-pointer mr-1"
                            for="grid-view-button"
                            matRipple>
                            <mat-icon
                                [ngClass]="productViewOrientation === 'grid' ? 'text-black dark:text-white' : 'text-gray'"
                                class="icon-size-4"
                                [svgIcon]="'block-view'"></mat-icon>
                        </label>
        
                        <!-- List view -->
                        <input
                            id="list-view-button"
                            type="button"
                            class="absolute h-0 w-0 opacity-0 invisible pointer-events-none"
                            (click)="productViewOrientation = 'list'"
                            mat-button>
                        <label 
                            class="flex items-center justify-center h-10 px-1 cursor-pointer sm:mr-2"
                            for="list-view-button"
                            matRipple>
                            <mat-icon
                                [ngClass]="productViewOrientation === 'list' ? 'text-black dark:text-white' : 'text-gray'"
                                class="icon-size-4"
                                [svgIcon]="'list-view'"></mat-icon>
                        </label>
                    </div>
                </div>

                <!-- product -->
                <div class="flex flex-col z-0">
                    <ng-container *ngIf="(products$ | async) as products">
                        <ng-container *ngIf="isLoading === false; else productLoading">
                            <store-products class="w-full" [products]="products" [productViewOrientation]="productViewOrientation" [store]="store" [storeSlug]="storeDomain" [catalogueSlug]="catalogueSlug"></store-products>
                            <!-- Pagination -->
                            <ng-container *ngIf="pagination">
                                <div class="flex w-full items-center justify-center">
                                    <pagination 
                                        [itemLength]="pagination.length" 
                                        [initialPage]="pagination.page + 1"
                                        [pageSize]="pagination.size"
                                        (changePage)="onChangePage($event)"
                                        (click)="scroll('scrollContainer')"
                                        #productPaginator></pagination>
                                </div>
                            </ng-container>
                        </ng-container>
                    </ng-container>
                </div>
            </div>
        </ng-container>
    </div>
</ng-container>